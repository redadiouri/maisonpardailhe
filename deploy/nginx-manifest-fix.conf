# Configuration à AJOUTER dans Nginx Proxy Manager
# Proxy Host → xn--maisonpardailh-okb.fr → Edit → Advanced → Custom Nginx Configuration

# IMPORTANT: Remplacer "maisonpardailhe" par le vrai nom de ton container Docker
# Pour vérifier: docker ps | grep maison

location = /manifest.json {
    # Utiliser le nom du container Docker au lieu de localhost
    # Si ton container s'appelle "maisonpardailhe" ou "maisonpardailhe-server"
    proxy_pass http://maisonpardailhe:3001/manifest.json;
    
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    
    # Désactiver l'authentification pour manifest.json
    auth_basic off;
    allow all;
    
    # Headers CORS et Content-Type
    add_header Access-Control-Allow-Origin * always;
    add_header Content-Type application/manifest+json always;
    add_header Cache-Control "no-cache, no-store, must-revalidate" always;
}

# Si tu as aussi des problèmes avec robots.txt ou sitemap.xml, ajoute:
location = /robots.txt {
    proxy_pass http://maisonpardailhe:3001/robots.txt;
    proxy_set_header Host $host;
    auth_basic off;
    allow all;
    add_header Content-Type text/plain always;
}

location = /sitemap.xml {
    proxy_pass http://maisonpardailhe:3001/sitemap.xml;
    proxy_set_header Host $host;
    auth_basic off;
    allow all;
    add_header Content-Type application/xml always;
}
